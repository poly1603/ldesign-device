{"version":3,"file":"useNetwork.js","sources":["../../src/composables/useNetwork.ts"],"sourcesContent":["import { ref, readonly, onUnmounted } from 'vue'\nimport type { NetworkInfo, DeviceDetector } from '@ldesign/device-core'\nimport { DeviceDetector as CoreDeviceDetector } from '@ldesign/device-core'\n\nexport function useNetwork() {\n  const networkInfo = ref<NetworkInfo | null>(null)\n  const isLoaded = ref(false)\n  let detector: DeviceDetector | null = null\n\n  async function loadModule() {\n    if (isLoaded.value) return\n    try {\n      detector = new CoreDeviceDetector({})\n      await detector.loadModule('network')\n      const module = detector.getModule('network')\n      if (module && typeof module.getData === 'function') {\n        networkInfo.value = module.getData()\n      }\n      detector.on('network:changed', () => {\n        const module = detector?.getModule('network')\n        if (module && typeof module.getData === 'function') {\n          networkInfo.value = module.getData()\n        }\n      })\n      isLoaded.value = true\n    } catch (error) {\n      console.error('Failed to load network module:', error)\n    }\n  }\n\n  function unloadModule() {\n    if (detector) {\n      detector.unloadModule('network')\n      detector = null\n    }\n    isLoaded.value = false\n    networkInfo.value = null\n  }\n\n  onUnmounted(() => {\n    unloadModule()\n  })\n\n  return {\n    networkInfo: readonly(networkInfo),\n    isLoaded: readonly(isLoaded),\n    loadModule,\n    unloadModule,\n  }\n}"],"names":["useNetwork","networkInfo","ref","isLoaded","detector","loadModule","value","CoreDeviceDetector","module","getModule","getData","on","error","console","unloadModule","onUnmounted","readonly"],"mappings":";;;;;;;;;;;;;;AAIO,SAASA,UAAAA,GAAa;AAC3B,EAAA,MAAMC,WAAAA,GAAcC,QAAwB,IAAI,CAAA;AAChD,EAAA,MAAMC,QAAAA,GAAWD,QAAI,KAAK,CAAA;AAC1B,EAAA,IAAIE,QAAAA,GAAkC,IAAA;AAEtC,EAAA,eAAeC,UAAAA,GAAa;AAC1B,IAAA,IAAIF,QAAAA,CAASG,KAAAA;AAAO,MAAA;AACpB,IAAA,IAAI;AACFF,MAAAA,QAAAA,GAAW,IAAIG,yBAAAA,CAAmB,EAAE,CAAA;AACpC,MAAA,MAAMH,QAAAA,CAASC,WAAW,SAAS,CAAA;AACnC,MAAA,MAAMG,MAAAA,GAASJ,QAAAA,CAASK,SAAAA,CAAU,SAAS,CAAA;AAC3C,MAAA,IAAID,MAAAA,IAAU,OAAOA,MAAAA,CAAOE,OAAAA,KAAY,UAAA,EAAY;AAClDT,QAAAA,WAAAA,CAAYK,KAAAA,GAAQE,OAAOE,OAAAA,EAAQ;AAAA,MACrC;AACAN,MAAAA,QAAAA,CAASO,EAAAA,CAAG,mBAAmB,MAAM;AACnC,QAAA,MAAMH,OAAAA,GAASJ,QAAAA,EAAUK,SAAAA,CAAU,SAAS,CAAA;AAC5C,QAAA,IAAID,OAAAA,IAAU,OAAOA,OAAAA,CAAOE,OAAAA,KAAY,UAAA,EAAY;AAClDT,UAAAA,WAAAA,CAAYK,KAAAA,GAAQE,QAAOE,OAAAA,EAAQ;AAAA,QACrC;AAAA,MACF,CAAC,CAAA;AACDP,MAAAA,QAAAA,CAASG,KAAAA,GAAQ,IAAA;AAAA,IACnB,SAASM,KAAAA,EAAO;AACdC,MAAAA,OAAAA,CAAQD,KAAAA,CAAM,kCAAkCA,KAAK,CAAA;AAAA,IACvD;AAAA,EACF;AAEA,EAAA,SAASE,YAAAA,GAAe;AACtB,IAAA,IAAIV,QAAAA,EAAU;AACZA,MAAAA,QAAAA,CAASU,aAAa,SAAS,CAAA;AAC/BV,MAAAA,QAAAA,GAAW,IAAA;AAAA,IACb;AACAD,IAAAA,QAAAA,CAASG,KAAAA,GAAQ,KAAA;AACjBL,IAAAA,WAAAA,CAAYK,KAAAA,GAAQ,IAAA;AAAA,EACtB;AAEAS,EAAAA,eAAAA,CAAY,MAAM;AAChBD,IAAAA,YAAAA,EAAa;AAAA,EACf,CAAC,CAAA;AAED,EAAA,OAAO;AAAA,IACLb,WAAAA,EAAae,aAASf,WAAW,CAAA;AAAA,IACjCE,QAAAA,EAAUa,aAASb,QAAQ,CAAA;AAAA,IAC3BE,UAAAA;AAAAA,IACAS;AAAAA,GACF;AACF;;;;;;;"}