{"version":3,"file":"FeatureDetectionModule.js","sources":["../../src/modules/FeatureDetectionModule.ts"],"sourcesContent":["import type { DeviceModule } from '../types'\nimport { EventEmitter } from '../core/EventEmitter'\n\n/**\n * 设备特性检测信息\n */\nexport interface FeatureDetectionInfo {\n  /** 存储支持 */\n  storage: {\n    localStorage: boolean\n    sessionStorage: boolean\n    indexedDB: boolean\n    cookies: boolean\n    cacheAPI: boolean\n    fileSystemAccess: boolean\n  }\n  /** 媒体支持 */\n  media: {\n    webp: boolean\n    avif: boolean\n    jxl: boolean\n    heic: boolean\n    webm: boolean\n    mp4: boolean\n    hls: boolean\n  }\n  /** CSS 特性支持 */\n  css: {\n    grid: boolean\n    flexbox: boolean\n    cssVariables: boolean\n    containerQueries: boolean\n    hasSelector: boolean\n    subgrid: boolean\n  }\n  /** API 支持 */\n  apis: {\n    serviceWorker: boolean\n    webWorker: boolean\n    webRTC: boolean\n    webSocket: boolean\n    webGL: boolean\n    webGL2: boolean\n    webGPU: boolean\n    webAssembly: boolean\n    webXR: boolean\n    webAudio: boolean\n    intersectionObserver: boolean\n    resizeObserver: boolean\n    mutationObserver: boolean\n  }\n  /** PWA 能力 */\n  pwa: {\n    pushNotifications: boolean\n    backgroundSync: boolean\n    periodicBackgroundSync: boolean\n    installable: boolean\n  }\n  /** 传感器支持 */\n  sensors: {\n    accelerometer: boolean\n    gyroscope: boolean\n    magnetometer: boolean\n    ambientLight: boolean\n  }\n  /** 用户偏好 */\n  preferences: {\n    darkMode: boolean\n    reducedMotion: boolean\n    reducedTransparency: boolean\n    highContrast: boolean\n  }\n  /** 设备能力 */\n  capabilities: {\n    touch: boolean\n    pointer: 'fine' | 'coarse' | 'none'\n    hover: boolean\n    vibration: boolean\n    clipboard: boolean\n    share: boolean\n    notifications: boolean\n  }\n  /** 硬件信息 */\n  hardware: {\n    cpuCores: number\n    deviceMemory: number // GB\n    maxTouchPoints: number\n  }\n}\n\n/**\n * 特性检测模块事件\n */\nexport interface FeatureDetectionEvents extends Record<string, unknown> {\n  featureChange: FeatureDetectionInfo\n  darkModeChange: boolean\n  reducedMotionChange: boolean\n}\n\n/**\n * 设备特性检测模块\n *\n * 提供全面的设备特性检测功能，包括：\n * - 存储 API 支持检测\n * - 媒体格式支持检测\n * - 现代 Web API 支持检测\n * - 用户偏好设置检测\n * - 硬件能力检测\n *\n * @example\n * ```typescript\n * const detector = new DeviceDetector()\n * const featureModule = await detector.loadModule<FeatureDetectionModule>('feature')\n * const features = featureModule.getData()\n *\n * if (features.media.webp) {\n *    }\n *\n * if (features.preferences.darkMode) {\n *    }\n * ```\n */\nexport class FeatureDetectionModule\n  extends EventEmitter<FeatureDetectionEvents>\n  implements DeviceModule {\n  name = 'feature'\n  private features: FeatureDetectionInfo | null = null\n  private mediaQueryListeners: Map<string, MediaQueryList> = new Map()\n  private isInitialized = false\n\n  /**\n   * 初始化模块\n   */\n  async init(): Promise<void> {\n    if (this.isInitialized)\n      return\n\n    this.features = await this.detectFeatures()\n    this.setupMediaQueryListeners()\n    this.isInitialized = true\n  }\n\n  /**\n   * 获取特性检测数据\n   */\n  getData(): FeatureDetectionInfo {\n    if (!this.features) {\n      throw new Error('FeatureDetectionModule not initialized')\n    }\n    return { ...this.features }\n  }\n\n  /**\n   * 检查是否支持暗黑模式\n   */\n  isDarkMode(): boolean {\n    return this.features?.preferences.darkMode ?? false\n  }\n\n  /**\n   * 检查是否偏好减少动画\n   */\n  prefersReducedMotion(): boolean {\n    return this.features?.preferences.reducedMotion ?? false\n  }\n\n  /**\n   * 检查是否支持 WebP\n   */\n  supportsWebP(): boolean {\n    return this.features?.media.webp ?? false\n  }\n\n  /**\n   * 检查是否支持 AVIF\n   */\n  supportsAVIF(): boolean {\n    return this.features?.media.avif ?? false\n  }\n\n  /**\n   * 获取 CPU 核心数\n   */\n  getCPUCores(): number {\n    return this.features?.hardware.cpuCores ?? 1\n  }\n\n  /**\n   * 获取设备内存（GB）\n   */\n  getDeviceMemory(): number {\n    return this.features?.hardware.deviceMemory ?? 0\n  }\n\n  /**\n   * 销毁模块\n   */\n  async destroy(): Promise<void> {\n    this.removeMediaQueryListeners()\n    this.removeAllListeners()\n    this.features = null\n    this.isInitialized = false\n  }\n\n  /**\n   * 检测所有特性\n   */\n  private async detectFeatures(): Promise<FeatureDetectionInfo> {\n    return {\n      storage: this.detectStorage(),\n      media: await this.detectMediaSupport(),\n      css: this.detectCSSFeatures(),\n      apis: this.detectAPIs(),\n      pwa: this.detectPWACapabilities(),\n      sensors: this.detectSensors(),\n      preferences: this.detectPreferences(),\n      capabilities: this.detectCapabilities(),\n      hardware: this.detectHardware(),\n    }\n  }\n\n  /**\n   * 检测存储支持\n   */\n  private detectStorage() {\n    return {\n      localStorage: this.checkLocalStorage(),\n      sessionStorage: this.checkSessionStorage(),\n      indexedDB: this.checkIndexedDB(),\n      cookies: this.checkCookies(),\n      cacheAPI: 'caches' in window,\n      fileSystemAccess: 'showOpenFilePicker' in window,\n    }\n  }\n\n  /**\n   * 检测媒体格式支持\n   */\n  private async detectMediaSupport() {\n    return {\n      webp: await this.checkImageFormat('webp'),\n      avif: await this.checkImageFormat('avif'),\n      jxl: false, // JPEG XL 还没有广泛支持\n      heic: false, // HEIC 主要在 iOS Safari 中支持\n      webm: this.checkVideoFormat('video/webm'),\n      mp4: this.checkVideoFormat('video/mp4'),\n      hls: this.checkHLSSupport(),\n    }\n  }\n\n  /**\n   * 检测 API 支持\n   */\n  private detectAPIs() {\n    return {\n      serviceWorker: 'serviceWorker' in navigator,\n      webWorker: typeof Worker !== 'undefined',\n      webRTC: 'RTCPeerConnection' in window,\n      webSocket: 'WebSocket' in window,\n      webGL: this.checkWebGL(),\n      webGL2: this.checkWebGL2(),\n      webGPU: 'gpu' in navigator,\n      webAssembly: typeof WebAssembly !== 'undefined',\n      webXR: 'xr' in navigator,\n      webAudio: 'AudioContext' in window || 'webkitAudioContext' in window,\n      intersectionObserver: 'IntersectionObserver' in window,\n      resizeObserver: 'ResizeObserver' in window,\n      mutationObserver: 'MutationObserver' in window,\n    }\n  }\n\n  /**\n   * 检测传感器支持\n   */\n  private detectSensors() {\n    return {\n      accelerometer: 'Accelerometer' in window,\n      gyroscope: 'Gyroscope' in window,\n      magnetometer: 'Magnetometer' in window,\n      ambientLight: 'AmbientLightSensor' in window,\n    }\n  }\n\n  /**\n   * 检测 CSS 特性支持\n   */\n  private detectCSSFeatures() {\n    if (typeof window === 'undefined' || !CSS || !CSS.supports) {\n      return {\n        grid: false,\n        flexbox: false,\n        cssVariables: false,\n        containerQueries: false,\n        hasSelector: false,\n        subgrid: false,\n      }\n    }\n\n    return {\n      grid: CSS.supports('display', 'grid'),\n      flexbox: CSS.supports('display', 'flex'),\n      cssVariables: CSS.supports('--test', 'value'),\n      containerQueries: CSS.supports('container-type', 'inline-size'),\n      hasSelector: CSS.supports('selector(:has(div))'),\n      subgrid: CSS.supports('grid-template-rows', 'subgrid'),\n    }\n  }\n\n  /**\n   * 检测 PWA 能力\n   */\n  private detectPWACapabilities() {\n    const pushNotifications = 'PushManager' in window\n    const backgroundSync = 'sync' in (ServiceWorkerRegistration.prototype || {})\n    const periodicBackgroundSync = 'periodicSync' in (ServiceWorkerRegistration.prototype || {})\n    const installable = 'onbeforeinstallprompt' in window\n\n    return {\n      pushNotifications,\n      backgroundSync,\n      periodicBackgroundSync,\n      installable,\n    }\n  }\n\n  /**\n   * 检测用户偏好\n   */\n  private detectPreferences() {\n    return {\n      darkMode: this.checkDarkMode(),\n      reducedMotion: this.checkReducedMotion(),\n      reducedTransparency: this.checkReducedTransparency(),\n      highContrast: this.checkHighContrast(),\n    }\n  }\n\n  /**\n   * 检测设备能力\n   */\n  private detectCapabilities() {\n    return {\n      touch: 'ontouchstart' in window || navigator.maxTouchPoints > 0,\n      pointer: this.detectPointerType(),\n      hover: this.checkHoverCapability(),\n      vibration: 'vibrate' in navigator,\n      clipboard: 'clipboard' in navigator,\n      share: 'share' in navigator,\n      notifications: 'Notification' in window,\n    }\n  }\n\n  /**\n   * 检测硬件信息\n   */\n  private detectHardware() {\n    return {\n      cpuCores: (navigator as unknown as { hardwareConcurrency?: number }).hardwareConcurrency || 1,\n      deviceMemory: (navigator as unknown as { deviceMemory?: number }).deviceMemory || 0,\n      maxTouchPoints: navigator.maxTouchPoints || 0,\n    }\n  }\n\n  /**\n   * 检查 LocalStorage 支持\n   */\n  private checkLocalStorage(): boolean {\n    try {\n      const test = '__test__'\n      localStorage.setItem(test, test)\n      localStorage.removeItem(test)\n      return true\n    }\n    catch {\n      return false\n    }\n  }\n\n  /**\n   * 检查 SessionStorage 支持\n   */\n  private checkSessionStorage(): boolean {\n    try {\n      const test = '__test__'\n      sessionStorage.setItem(test, test)\n      sessionStorage.removeItem(test)\n      return true\n    }\n    catch {\n      return false\n    }\n  }\n\n  /**\n   * 检查 IndexedDB 支持\n   */\n  private checkIndexedDB(): boolean {\n    return 'indexedDB' in window\n  }\n\n  /**\n   * 检查 Cookies 支持\n   */\n  private checkCookies(): boolean {\n    return navigator.cookieEnabled\n  }\n\n  /**\n   * 检查图片格式支持\n   */\n  private checkImageFormat(format: 'webp' | 'avif'): Promise<boolean> {\n    return new Promise((resolve) => {\n      const img = new Image()\n      img.onload = () => resolve(img.width === 1)\n      img.onerror = () => resolve(false)\n\n      const formats = {\n        webp: 'data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=',\n        avif: 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=',\n      }\n\n      img.src = formats[format]\n    })\n  }\n\n  /**\n   * 检查视频格式支持\n   */\n  private checkVideoFormat(mimeType: string): boolean {\n    const video = document.createElement('video')\n    return video.canPlayType(mimeType) !== ''\n  }\n\n  /**\n   * 检查 HLS 支持\n   */\n  private checkHLSSupport(): boolean {\n    const video = document.createElement('video')\n    return video.canPlayType('application/vnd.apple.mpegurl') !== ''\n  }\n\n  /**\n   * 检查 WebGL 支持\n   */\n  private checkWebGL(): boolean {\n    try {\n      const canvas = document.createElement('canvas')\n      return !!(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'))\n    }\n    catch {\n      return false\n    }\n  }\n\n  /**\n   * 检查 WebGL2 支持\n   */\n  private checkWebGL2(): boolean {\n    try {\n      const canvas = document.createElement('canvas')\n      return !!canvas.getContext('webgl2')\n    }\n    catch {\n      return false\n    }\n  }\n\n  /**\n   * 检查暗黑模式\n   */\n  private checkDarkMode(): boolean {\n    if (typeof window === 'undefined')\n      return false\n    return window.matchMedia('(prefers-color-scheme: dark)').matches\n  }\n\n  /**\n   * 检查减少动画偏好\n   */\n  private checkReducedMotion(): boolean {\n    if (typeof window === 'undefined')\n      return false\n    return window.matchMedia('(prefers-reduced-motion: reduce)').matches\n  }\n\n  /**\n   * 检查减少透明度偏好\n   */\n  private checkReducedTransparency(): boolean {\n    if (typeof window === 'undefined')\n      return false\n    return window.matchMedia('(prefers-reduced-transparency: reduce)').matches\n  }\n\n  /**\n   * 检查高对比度偏好\n   */\n  private checkHighContrast(): boolean {\n    if (typeof window === 'undefined')\n      return false\n    return window.matchMedia('(prefers-contrast: high)').matches\n  }\n\n  /**\n   * 检测指针类型\n   */\n  private detectPointerType(): 'fine' | 'coarse' | 'none' {\n    if (typeof window === 'undefined')\n      return 'none'\n    if (window.matchMedia('(pointer: fine)').matches)\n      return 'fine'\n    if (window.matchMedia('(pointer: coarse)').matches)\n      return 'coarse'\n    return 'none'\n  }\n\n  /**\n   * 检查悬停能力\n   */\n  private checkHoverCapability(): boolean {\n    if (typeof window === 'undefined')\n      return false\n    return window.matchMedia('(hover: hover)').matches\n  }\n\n  /**\n   * 设置媒体查询监听器\n   */\n  private setupMediaQueryListeners(): void {\n    if (typeof window === 'undefined')\n      return\n\n    // 监听暗黑模式变化\n    const darkModeQuery = window.matchMedia('(prefers-color-scheme: dark)')\n    const darkModeHandler = (e: MediaQueryListEvent) => {\n      if (this.features) {\n        this.features.preferences.darkMode = e.matches\n        this.emit('darkModeChange', e.matches)\n        this.emit('featureChange', this.features)\n      }\n    }\n    darkModeQuery.addEventListener('change', darkModeHandler)\n    this.mediaQueryListeners.set('darkMode', darkModeQuery)\n\n    // 监听减少动画偏好变化\n    const reducedMotionQuery = window.matchMedia('(prefers-reduced-motion: reduce)')\n    const reducedMotionHandler = (e: MediaQueryListEvent) => {\n      if (this.features) {\n        this.features.preferences.reducedMotion = e.matches\n        this.emit('reducedMotionChange', e.matches)\n        this.emit('featureChange', this.features)\n      }\n    }\n    reducedMotionQuery.addEventListener('change', reducedMotionHandler)\n    this.mediaQueryListeners.set('reducedMotion', reducedMotionQuery)\n  }\n\n  /**\n   * 移除媒体查询监听器\n   */\n  private removeMediaQueryListeners(): void {\n    this.mediaQueryListeners.clear()\n  }\n}\n"],"names":["FeatureDetectionModule","EventEmitter","name","features","mediaQueryListeners","Map","isInitialized","init","detectFeatures","setupMediaQueryListeners","getData","Error","isDarkMode","preferences","darkMode","prefersReducedMotion","reducedMotion","supportsWebP","media","webp","supportsAVIF","avif","getCPUCores","hardware","cpuCores","getDeviceMemory","deviceMemory","destroy","removeMediaQueryListeners","removeAllListeners","storage","detectStorage","detectMediaSupport","css","detectCSSFeatures","apis","detectAPIs","pwa","detectPWACapabilities","sensors","detectSensors","detectPreferences","capabilities","detectCapabilities","detectHardware","localStorage","checkLocalStorage","sessionStorage","checkSessionStorage","indexedDB","checkIndexedDB","cookies","checkCookies","cacheAPI","window","fileSystemAccess","checkImageFormat","jxl","heic","webm","checkVideoFormat","mp4","hls","checkHLSSupport","serviceWorker","navigator","webWorker","Worker","webRTC","webSocket","webGL","checkWebGL","webGL2","checkWebGL2","webGPU","webAssembly","WebAssembly","webXR","webAudio","intersectionObserver","resizeObserver","mutationObserver","accelerometer","gyroscope","magnetometer","ambientLight","CSS","supports","grid","flexbox","cssVariables","containerQueries","hasSelector","subgrid","pushNotifications","backgroundSync","ServiceWorkerRegistration","prototype","periodicBackgroundSync","installable","checkDarkMode","checkReducedMotion","reducedTransparency","checkReducedTransparency","highContrast","checkHighContrast","touch","maxTouchPoints","pointer","detectPointerType","hover","checkHoverCapability","vibration","clipboard","share","notifications","hardwareConcurrency","test","setItem","removeItem","cookieEnabled","format","Promise","resolve","img","Image","onload","width","onerror","formats","src","mimeType","video","document","createElement","canPlayType","canvas","getContext","matchMedia","matches","darkModeQuery","darkModeHandler","e","emit","addEventListener","set","reducedMotionQuery","reducedMotionHandler","clear"],"mappings":"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"}